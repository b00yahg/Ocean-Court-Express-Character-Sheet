<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oceans Court Express - Ship Character Sheet</title>
    <style>
        :root {
            --primary: #1a3a5a;
            --secondary: #3d6a8a;
            --accent: #ffcc00;
            --light: #e1eef6;
            --dark: #0a1a2a;
            --danger: #d9534f;
            --success: #5cb85c;
            --warning: #f0ad4e;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f0f5f9;
            color: var(--dark);
            padding: 20px;
        }

        .sheet-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.05;
            width: 80%;
            z-index: 0;
            pointer-events: none;
        }

        .sheet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .ship-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            border-bottom: 2px solid var(--accent);
            margin-bottom: 5px;
        }

        .ship-class {
            font-size: 1.2rem;
            color: var(--secondary);
            font-style: italic;
        }

        .save-container {
            text-align: right;
        }

        .save-btn {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .save-btn:hover {
            background-color: #4cae4c;
            transform: translateY(-2px);
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 15px;
            position: relative;
            z-index: 1;
        }

        .section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 15px;
            border-top: 4px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 8px;
            color: var(--accent);
        }

        .ship-stats {
            grid-column: span 12;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stats-container {
            /* For the left side of ship stats */
        }

        .crew-container {
            /* For the right side of ship stats (crew details) */
        }

        .captain {
            grid-column: span 6;
            border-top-color: #6a1b9a;
        }

        .helmsman {
            grid-column: span 6;
            border-top-color: #0277bd;
        }

        .gunner {
            grid-column: span 12;
            border-top-color: #d32f2f;
        }

        .boatswain {
            grid-column: span 12;
            border-top-color: #388e3c;
        }

        .role-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .captain .role-badge {
            background-color: #6a1b9a;
        }

        .helmsman .role-badge {
            background-color: #0277bd;
        }

        .gunner .role-badge {
            background-color: #d32f2f;
        }

        .boatswain .role-badge {
            background-color: #388e3c;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-block {
            background-color: var(--light);
            padding: 10px;
            border-radius: 5px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--secondary);
            display: block;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--dark);
            width: 100%;
            background: transparent;
            border: none;
            text-align: center;
        }

        .stat-value:focus {
            outline: 2px solid var(--accent);
            border-radius: 3px;
        }

        .initiative-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 15px 0;
        }

        .initiative-label {
            font-weight: bold;
            color: var(--secondary);
            margin-right: 10px;
        }

        .initiative-value {
            width: 60px;
            padding: 5px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .ability-list {
            margin-top: 15px;
        }

        .ability-item {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #e1e1e1;
        }

        .ability-name {
            font-weight: bold;
            margin-bottom: 3px;
            color: var(--primary);
        }

        .ability-desc {
            font-size: 0.9rem;
            color: #555;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th {
            background-color: var(--primary);
            color: white;
            text-align: left;
            padding: 10px;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .weapon-property {
            display: inline-block;
            background-color: var(--light);
            color: var(--secondary);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-top: 5px;
        }

        .power-module {
            background-color: var(--light);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 4px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .power-module.active {
            background-color: rgba(56, 142, 60, 0.15);
            border-left-color: #388e3c;
        }

        .power-module:hover {
            transform: translateX(5px);
        }

        .power-module.error {
            animation: shake 0.5s;
            border-left-color: var(--danger);
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .power-info {
            flex: 1;
        }

        .power-name {
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .power-cost {
            background-color: var(--secondary);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 8px;
        }

        .power-hp {
            margin-left: 15px;
            font-size: 0.9rem;
            color: #555;
        }

        .power-desc {
            font-size: 0.9rem;
            margin-top: 5px;
            color: #555;
        }

        .power-toggle {
            width: 40px;
            height: 20px;
            background-color: #ddd;
            border-radius: 10px;
            position: relative;
            transition: all 0.2s ease;
        }

        .power-toggle::after {
            content: '';
            width: 16px;
            height: 16px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.2s ease;
        }

        .power-module.active .power-toggle {
            background-color: #388e3c;
        }

        .power-module.active .power-toggle::after {
            left: 22px;
        }

        .command-options {
            display: flex;
            margin-top: 10px;
            gap: 10px;
            flex-direction: column;
        }

        .command-option {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .command-option.selected {
            border-color: #6a1b9a;
            background-color: rgba(106, 27, 154, 0.1);
        }

        .crew-table {
            width: 100%;
            margin-top: 15px;
        }

        .crew-table th {
            background-color: var(--secondary);
            color: white;
            text-align: left;
            padding: 8px;
            font-size: 0.9rem;
        }

        .crew-table td {
            padding: 8px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .crew-count {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .crew-count-label {
            font-weight: bold;
            margin-right: 10px;
        }

        .crew-count-value {
            background-color: var(--light);
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
        }

        .movement-details {
            margin-top: 15px;
            padding: 15px;
            background-color: var(--light);
            border-radius: 5px;
        }

        .movement-item {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .movement-label {
            font-weight: bold;
            color: var(--secondary);
            min-width: 160px;
        }

        .movement-value {
            font-weight: bold;
        }

        .movement-note {
            font-size: 0.8rem;
            color: #777;
            margin-left: 10px;
            font-style: italic;
        }

        .weapon-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            align-items: center;
        }

        .weapon-header {
            font-weight: bold;
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .weapon-property-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .number-input {
            width: 60px;
            text-align: center;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        .power-charge-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .power-charge-label {
            font-weight: bold;
            color: var(--secondary);
        }

        .power-charge-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
            font-weight: bold;
        }

        .active-modules-counter {
            background-color: var(--secondary);
            color: white;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.9rem;
            margin-left: 10px;
        }

        .hp-display {
            display: flex;
            align-items: center;
        }

        .hp-current {
            margin-right: 2px;
        }

        .hp-max {
            margin-left: 2px;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip i {
            color: var(--secondary);
            font-size: 0.8rem;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark) transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* File upload button styles */
        .file-upload-label {
            display: inline-flex;
            align-items: center;
            background-color: var(--secondary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
            transition: all 0.2s;
        }

        .file-upload-label:hover {
            background-color: #1a5b8c;
        }

        .file-upload-label span {
            margin-left: 5px;
        }

        .file-upload-input {
            display: none;
        }

        .crew-role {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .crew-role-name {
            min-width: 100px;
            margin-right: 10px;
        }

        .crew-role-player {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            flex-grow: 1;
        }

        .gunner-dropdown {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 100%;
        }

        .maneuver {
            margin-bottom: 15px;
            padding: 10px;
            background-color: var(--light);
            border-radius: 5px;
        }

        .maneuver-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .maneuver-level {
            font-size: 0.8rem;
            color: var(--secondary);
            font-weight: normal;
        }

        @media print {
            body {
                background-color: white;
            }
            
            .sheet-container {
                box-shadow: none;
            }
            
            .save-container {
                display: none;
            }

            .file-upload-label {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="sheet-container">
        <img src="/api/placeholder/800/600" alt="Ship Silhouette" class="watermark">
        
        <div class="sheet-header">
            <div>
                <input type="text" class="ship-name" value="Oceans Court Express" id="shipName">
                <div class="ship-class">Frigate Class (2×2)</div>
            </div>
            <div class="save-container">
                <button class="save-btn" onclick="saveSheet()">SAVE SHEET</button>
            </div>
        </div>
        
        <div class="grid-container">
            <!-- Ship Stats Section -->
            <div class="section ship-stats">
                <div class="stats-container">
                    <h2 class="section-title">
                        <i>⚓</i> Ship Attributes
                    </h2>
                    <div class="stat-grid">
                        <div class="stat-block">
                            <label class="stat-label">Armor Class (AC)</label>
                            <input type="number" class="stat-value" value="16" id="shipAC">
                        </div>
                        <div class="stat-block">
                            <label class="stat-label">Hull Points</label>
                            <div class="hp-display">
                                <input type="number" class="stat-value hp-current" value="100" id="currentHP" style="width: 45%">
                                <span>/</span>
                                <input type="number" class="stat-value hp-max" value="100" id="maxHP" style="width: 45%">
                            </div>
                        </div>
                        <div class="stat-block">
                            <label class="stat-label">Temporary Hull Points</label>
                            <input type="number" class="stat-value" value="0" id="tempHP">
                        </div>
                        <div class="stat-block">
                            <label class="stat-label">Air Supply (Days)</label>
                            <input type="number" class="stat-value" value="30" id="airSupply">
                        </div>
                    </div>
                </div>
                
                <div class="crew-container">
                    <h2 class="section-title">
                        <i>👥</i> Crew Details
                    </h2>
                    
                    <div class="crew-count">
                        <div class="crew-count-label">Current Crew:</div>
                        <div class="crew-count-value">
                            <span id="currentCrewCount">5</span>/15
                        </div>
                        <div style="margin-left: 10px; font-size: 0.8rem; color: #777;">(Minimum: 5)</div>
                    </div>
                    
                    <table class="crew-table">
                        <thead>
                            <tr>
                                <th>Crew Type</th>
                                <th>Cost per Day</th>
                                <th>Number</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Green Crew (CR 1/8)</td>
                                <td>1.5 gp</td>
                                <td>
                                    <input type="number" class="number-input crew-number" value="0" min="0" data-cost="1.5" id="greenCrew">
                                </td>
                            </tr>
                            <tr>
                                <td>Mercenaries (CR 1/2)</td>
                                <td>3 gp</td>
                                <td>
                                    <input type="number" class="number-input crew-number" value="0" min="0" data-cost="3" id="mercenaries">
                                </td>
                            </tr>
                            <tr>
                                <td>Veteran Crew (CR 1/2 or CR 2)</td>
                                <td>5 gp</td>
                                <td>
                                    <input type="number" class="number-input crew-number" value="0" min="0" data-cost="5" id="veteranCrew">
                                </td>
                            </tr>
                            <tr>
                                <td>Giff Mercenaries (CR 3)</td>
                                <td>6.5 gp</td>
                                <td>
                                    <input type="number" class="number-input crew-number" value="0" min="0" data-cost="6.5" id="giffMercenaries">
                                </td>
                            </tr>
                            <tr>
                                <td>Hurwaeti Mercenaries (CR 4)</td>
                                <td>8 gp</td>
                                <td>
                                    <input type="number" class="number-input crew-number" value="0" min="0" data-cost="8" id="hurwaetiMercenaries">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 15px; display: flex; justify-content: space-between;">
                        <div style="font-weight: bold;">Daily Crew Cost:</div>
                        <div id="dailyCrewCost">0 gp</div>
                    </div>
                    
                    <div class="crew-roles" style="margin-top: 20px;">
                        <div class="crew-role">
                            <div class="crew-role-name">Captain:</div>
                            <input type="text" class="crew-role-player" id="captainPlayer" placeholder="Player name...">
                            <label class="file-upload-label">
                                <input type="file" class="file-upload-input" id="captainUpload" accept=".json" onchange="handleFileUpload(event, 'captain')">
                                <i>📄</i><span>Upload</span>
                            </label>
                        </div>
                        <div class="crew-role">
                            <div class="crew-role-name">Helmsman:</div>
                            <input type="text" class="crew-role-player" id="helmsmanPlayer" placeholder="Player name...">
                            <label class="file-upload-label">
                                <input type="file" class="file-upload-input" id="helmsmanUpload" accept=".json" onchange="handleFileUpload(event, 'helmsman')">
                                <i>📄</i><span>Upload</span>
                            </label>
                        </div>
                        <div class="crew-role">
                            <div class="crew-role-name">Gunner:</div>
                            <input type="text" class="crew-role-player" id="gunnerPlayer" placeholder="Player name...">
                            <label class="file-upload-label">
                                <input type="file" class="file-upload-input" id="gunnerUpload" accept=".json" onchange="handleFileUpload(event, 'gunner')">
                                <i>📄</i><span>Upload</span>
                            </label>
                        </div>
                        <div class="crew-role">
                            <div class="crew-role-name">Gunner 2:</div>
                            <input type="text" class="crew-role-player" id="gunner2Player" placeholder="Player name...">
                            <label class="file-upload-label">
                                <input type="file" class="file-upload-input" id="gunner2Upload" accept=".json" onchange="handleFileUpload(event, 'gunner2')">
                                <i>📄</i><span>Upload</span>
                            </label>
                        </div>
                        <div class="crew-role">
                            <div class="crew-role-name">Boatswain:</div>
                            <input type="text" class="crew-role-player" id="boatswainPlayer" placeholder="Player name...">
                            <label class="file-upload-label">
                                <input type="file" class="file-upload-input" id="boatswainUpload" accept=".json" onchange="handleFileUpload(event, 'boatswain')">
                                <i>📄</i><span>Upload</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Captain Section -->
            <div class="section captain">
                <span class="role-badge">CAPTAIN</span>
                <h2 class="section-title">
                    <i>🎖️</i> Captain's Station
                </h2>
                
                <div class="initiative-container">
                    <div class="initiative-label">Ship Initiative:</div>
                    <input type="text" class="initiative-value" value="+2" id="shipInitiative">
                </div>
                
                <div class="ability-list">
                    <div class="ability-item">
                        <div class="ability-name">Hailing</div>
                        <div class="ability-desc">You can hail other vessels, functioning as a Sending spell to communicate with another ship's Captain.</div>
                    </div>
                    
                    <div class="ability-item">
                        <div class="ability-name">Captain's Commands</div>
                        <div class="ability-desc">At the beginning of combat, select one command:</div>
                    </div>
                </div>
                
                <div class="command-options">
                    <div class="command-option" onclick="selectCommand(this, 'gunner')" id="gunnerCommand">
                        <strong>Offensive Order:</strong> Allow the Gunner to make an additional weapon attack with any ship weapon during their turn.
                    </div>
                    <div class="command-option" onclick="selectCommand(this, 'boatswain')" id="boatswainCommand">
                        <strong>Engineering Order:</strong> Enable the Boatswain to allocate one additional power charge beyond their proficiency bonus.
                    </div>
                    <div class="command-option" onclick="selectCommand(this, 'helmsman')" id="helmsmanCommand">
                        <strong>Tactical Order:</strong> Grant the Helmsman +2 to their Wisdom (Vehicle) checks for maneuvering and collision avoidance until the start of your next turn.
                    </div>
                </div>
                
                <div class="ability-list">
                    <h3 style="margin-top: 15px; color: #6a1b9a;">Special Actions</h3>
                    
                    <div class="ability-item">
                        <div class="ability-name">Grappling Ropes</div>
                        <div class="ability-desc">When within 5 feet of another vessel, make a Charisma (Vehicles) check to grapple ships together.</div>
                    </div>
                    
                    <div class="ability-item">
                        <div class="ability-name">To Me, Ocean Court</div>
                        <div class="ability-desc">Call a boarding/defense party. Crew members who haven't taken their turn teleport to your position.</div>
                    </div>
                </div>
            </div>
            
            <!-- Helmsman Section -->
            <div class="section helmsman">
                <span class="role-badge">HELMSMAN</span>
                <h2 class="section-title">
                    <i>🧭</i> Helm Control
                </h2>
                
                <div class="movement-details">
                    <div class="movement-item">
                        <div class="movement-label">Starting Base Velocity:</div>
                        <div class="movement-value">500 feet</div>
                    </div>
                    <div class="movement-item">
                        <div class="movement-label">Max Acceleration:</div>
                        <div class="movement-value">200 ft./round</div>
                        <div class="movement-note">OR 600 ft./round IF you overdrive (risk of overload)</div>
                    </div>
                    <div class="movement-item">
                        <div class="movement-label">Max Deceleration:</div>
                        <div class="movement-value">200 ft./round</div>
                        <div class="movement-note">OR 600 ft./round IF you use the emergency brake (risk of damage)</div>
                    </div>
                </div>
                
                <div class="stat-grid" style="margin-top: 15px;">
                    <div class="stat-block">
                        <label class="stat-label">Current Velocity</label>
                        <input type="number" class="stat-value" value="500" id="currentVelocityHelm"> ft/round
                    </div>
                    <div class="stat-block">
                        <label class="stat-label">Current Direction</label>
                        <select class="stat-value" id="currentDirectionHelm">
                            <option value="N">North</option>
                            <option value="NE">Northeast</option>
                            <option value="E" selected>East</option>
                            <option value="SE">Southeast</option>
                            <option value="S">South</option>
                            <option value="SW">Southwest</option>
                            <option value="W">West</option>
                            <option value="NW">Northwest</option>
                        </select>
                    </div>
                </div>
                
                <div class="maneuver">
                    <div class="maneuver-title">Overdrive <span class="maneuver-level">(Special Action)</span></div>
                    <div class="ability-desc">Triple maximum acceleration, but requires a Wisdom (Vehicle) check. On failure, acceleration capability is zero on your next turn.</div>
                </div>
                
                <div class="maneuver">
                    <div class="maneuver-title">Emergency Brake <span class="maneuver-level">(Special Action)</span></div>
                    <div class="ability-desc">Triple normal deceleration limit. Requires a Wisdom (Vehicle) check. On failure, the ship takes 2d6 force damage.</div>
                </div>
                
                <div class="maneuver">
                    <div class="maneuver-title">Maneuver - Evade <span class="maneuver-level">(1st-level)</span></div>
                    <div class="ability-desc">As a reaction, expend a 1st-level spell slot to add proficiency bonus to ship's AC or Wisdom (Vehicle) checks until your next turn.</div>
                </div>
                
                <div class="maneuver">
                    <div class="maneuver-title">Maneuver - Jamming <span class="maneuver-level">(3rd-level)</span></div>
                    <div class="ability-desc">Expend a 3rd-level spell slot to match speed and acceleration of a target vessel within 5 feet for 1 minute.</div>
                </div>
            </div>
            
            <!-- Gunner Section with Weapons -->
            <div class="section gunner">
                <span class="role-badge">GUNNER</span>
                <h2 class="section-title">
                    <i>🎯</i> Weapons Control
                </h2>
                
                <div class="ability-item" style="margin-top: 10px;">
                    <div class="ability-name">Weapon Proficiency</div>
                    <div class="ability-desc">Add your DEX modifier + proficiency bonus to attack and damage rolls with ship weapons.</div>
                </div>
                
                <div style="margin-top: 15px;">
                    <h3 style="color: #d32f2f; margin-bottom: 10px;">Ship Weapons</h3>
                    
                    <div class="weapon-row" style="background-color: var(--light); font-weight: bold;">
                        <div class="weapon-header">Weapon</div>
                        <div class="weapon-header">Range</div>
                        <div class="weapon-header">To Hit</div>
                        <div class="weapon-header">Damage</div>
                        <div class="weapon-header">Position</div>
                        <div class="weapon-header">Properties</div>
                        <div class="weapon-header">Assigned Gunner</div>
                    </div>
                    
                    <div class="weapon-row">
                        <div>Flower Cannon</div>
                        <div>300/900 ft.</div>
                        <div>
                            <input type="text" class="number-input" value="+6" id="rightCannonToHit">
                        </div>
                        <div>3d10 radiant</div>
                        <div>Right Broadside</div>
                        <div class="weapon-property-container">
                            <div class="weapon-property">90° Firing Arc</div>
                            <div class="weapon-property">HP: <input type="number" style="width: 30px; display: inline-block;" value="10" max="10" min="0" id="rightCannonHP"></div>
                        </div>
                        <div>
                            <select class="gunner-dropdown" id="rightCannonGunner">
                                <option value="">Select Gunner...</option>
                                <option value="gunner">Primary Gunner</option>
                                <option value="gunner2">Secondary Gunner</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="weapon-row">
                        <div>Flower Cannon</div>
                        <div>300/900 ft.</div>
                        <div>
                            <input type="text" class="number-input" value="+6" id="leftCannonToHit">
                        </div>
                        <div>3d10 radiant</div>
                        <div>Left Broadside</div>
                        <div class="weapon-property-container">
                            <div class="weapon-property">90° Firing Arc</div>
                            <div class="weapon-property">HP: <input type="number" style="width: 30px; display: inline-block;" value="10" max="10" min="0" id="leftCannonHP"></div>
                        </div>
                        <div>
                            <select class="gunner-dropdown" id="leftCannonGunner">
                                <option value="">Select Gunner...</option>
                                <option value="gunner">Primary Gunner</option>
                                <option value="gunner2">Secondary Gunner</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="weapon-row">
                        <div>Carronade</div>
                        <div>500/1500 ft.</div>
                        <div>
                            <input type="text" class="number-input" value="+6" id="carronadeToHit">
                        </div>
                        <div>8d10 bludgeoning</div>
                        <div>Front (Bow)</div>
                        <div class="weapon-property-container">
                            <div class="weapon-property">Utilize</div>
                            <div class="weapon-property">45° Firing Arc</div>
                            <div class="weapon-property">HP: <input type="number" style="width: 30px; display: inline-block;" value="10" max="10" min="0" id="carronadeHP"></div>
                            <div class="tooltip"><i>ℹ️</i>
                                <span class="tooltip-text">Utilize: Once fired, requires another action to charge before firing again.</span>
                            </div>
                        </div>
                        <div>
                            <select class="gunner-dropdown" id="carronadeGunner">
                                <option value="">Select Gunner...</option>
                                <option value="gunner">Primary Gunner</option>
                                <option value="gunner2">Secondary Gunner</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="ability-list">
                    <h3 style="margin-top: 15px; color: #d32f2f;">Special Actions</h3>
                    
                    <div class="ability-item">
                        <div class="ability-name">Switch Weapons</div>
                        <div class="ability-desc">As a bonus action, switch between different weapon systems.</div>
                    </div>
                    
                    <div class="ability-item">
                        <div class="ability-name">Trigger on the Pulse</div>
                        <div class="ability-desc">Ready a ship weapon attack to fire at a specific trigger.</div>
                    </div>
                </div>
            </div>
            
            <!-- Boatswain Section -->
            <div class="section boatswain">
                <span class="role-badge">BOATSWAIN</span>
                <h2 class="section-title">
                    <i>⚡</i> Power Systems
                </h2>
                
                <div class="power-charge-container">
                    <div class="power-charge-label">Available Power Charges:</div>
                    <input type="number" class="power-charge-input" value="4" min="0" id="availablePowerCharges">
                    <div>(Proficiency Bonus)</div>
                    <div class="active-modules-counter">Active: <span id="activeModulesCount">0</span>/<span id="maxModules">4</span></div>
                </div>
                
                <div id="powerModules">
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="1" id="weaponsArray">
                        <div class="power-info">
                            <div class="power-name">
                                Weapons Array
                                <span class="power-cost">1 Charge</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="weaponsArrayHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">+1d6 damage to all weapon attacks until the start of your next turn</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                    
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="1" id="deflectorGrid">
                        <div class="power-info">
                            <div class="power-name">
                                Deflector Grid
                                <span class="power-cost">1 Charge</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="deflectorGridHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">Ship gains resistance to one damage type until the start of your next turn</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                    
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="1" id="thrusterOverride">
                        <div class="power-info">
                            <div class="power-name">
                                Thruster Override
                                <span class="power-cost">1 Charge</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="thrusterOverrideHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">+100 feet to the ship's maximum acceleration or deceleration this turn</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                    
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="1" id="hullReinforcement">
                        <div class="power-info">
                            <div class="power-name">
                                Hull Reinforcement
                                <span class="power-cost">1 Charge</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="hullReinforcementHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">Ship gains 2d8 temporary hit points</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                    
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="1" id="systemRestoration">
                        <div class="power-info">
                            <div class="power-name">
                                System Restoration
                                <span class="power-cost">1 Charge</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="systemRestorationHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">If a weapon system or module has dropped to zero hit points, restore it to functioning at 1 hit point</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                    
                    <div class="power-module" onclick="togglePowerModule(this)" data-cost="2" id="warpCoreCharge">
                        <div class="power-info">
                            <div class="power-name">
                                Warp Core Charge
                                <span class="power-cost">2 Charges</span>
                                <span class="power-hp">HP: <input type="number" class="number-input" style="width: 40px;" value="10" max="10" min="0" id="warpCoreChargeHP" onclick="event.stopPropagation();"></span>
                            </div>
                            <div class="power-desc">After 3 consecutive turns of charging, can initiate warp jump to escape combat</div>
                        </div>
                        <div class="power-toggle"></div>
                    </div>
                </div>
                
                <div class="ability-list">
                    <h3 style="margin-top: 15px; color: #388e3c;">Special Actions</h3>
                    
                    <div class="ability-item">
                        <div class="ability-name">Arcane Overclock</div>
                        <div class="ability-desc">As an action, expend a spell slot to gain additional power charges equal to the spell slot level for this turn only.</div>
                    </div>
                    
                    <div class="ability-item">
                        <div class="ability-name">Emergency Hotfix</div>
                        <div class="ability-desc">When the ship drops below half its hull points, use your reaction to immediately reallocate 1 power charge.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
